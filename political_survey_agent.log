2025-09-06 18:48:00,249 - __main__ - INFO - Starting Political Survey Google Forms Automation Agent
2025-09-06 18:48:00,249 - __main__ - INFO - Loading configuration...
2025-09-06 18:48:00,252 - __main__ - INFO - Configuration loaded successfully
2025-09-06 18:48:00,252 - __main__ - INFO - Initializing Excel processor...
2025-09-06 18:48:00,252 - excel_processor - INFO - Loading Excel file: ./survey_data.xlsx
2025-09-06 18:48:00,363 - excel_processor - INFO - Loaded sheet 'AC<>PC' with 3 rows
2025-09-06 18:48:00,365 - excel_processor - INFO - Loaded sheet 'GE2024' with 6 rows
2025-09-06 18:48:00,368 - excel_processor - INFO - Loaded sheet 'MLA_P2' with 6 rows
2025-09-06 18:48:00,371 - excel_processor - INFO - Loaded sheet 'Caste_Data' with 6 rows
2025-09-06 18:48:00,373 - __main__ - INFO - Excel processor initialized successfully
2025-09-06 18:48:00,373 - __main__ - INFO - Extracting AC numbers from Excel data...
2025-09-06 18:48:00,373 - excel_processor - INFO - Found 3 AC numbers in ac_pc
2025-09-06 18:48:00,373 - excel_processor - INFO - Found 3 AC numbers in ge2024
2025-09-06 18:48:00,374 - excel_processor - INFO - Found 3 AC numbers in mla_p2
2025-09-06 18:48:00,374 - excel_processor - INFO - Found 3 AC numbers in caste_data
2025-09-06 18:48:00,374 - excel_processor - INFO - Total unique AC numbers found: 3
2025-09-06 18:48:00,374 - __main__ - INFO - Found 3 unique AC numbers
2025-09-06 18:48:00,374 - __main__ - INFO - Extracting survey data for all AC numbers...
2025-09-06 18:48:00,374 - __main__ - INFO - Processing AC 1...
2025-09-06 18:48:00,374 - excel_processor - INFO - Extracting all data for AC 1
2025-09-06 18:48:00,375 - excel_processor - INFO - Found 5 party options for AC 1
2025-09-06 18:48:00,375 - excel_processor - INFO - Found 2 MP candidates for AC 1
2025-09-06 18:48:00,376 - excel_processor - INFO - Found 2 MLA candidates for AC 1
2025-09-06 18:48:00,376 - excel_processor - INFO - Found 1 Congress candidates for AC 1
2025-09-06 18:48:00,376 - excel_processor - INFO - Found 2 caste options for AC 1
2025-09-06 18:48:00,376 - __main__ - INFO - Successfully extracted data for AC 1
2025-09-06 18:48:00,376 - __main__ - INFO - Processing AC 2...
2025-09-06 18:48:00,376 - excel_processor - INFO - Extracting all data for AC 2
2025-09-06 18:48:00,377 - excel_processor - INFO - Found 5 party options for AC 2
2025-09-06 18:48:00,377 - excel_processor - INFO - Found 2 MP candidates for AC 2
2025-09-06 18:48:00,377 - excel_processor - INFO - Found 2 MLA candidates for AC 2
2025-09-06 18:48:00,378 - excel_processor - INFO - Found 1 Congress candidates for AC 2
2025-09-06 18:48:00,378 - excel_processor - INFO - Found 2 caste options for AC 2
2025-09-06 18:48:00,378 - __main__ - INFO - Successfully extracted data for AC 2
2025-09-06 18:48:00,378 - __main__ - INFO - Processing AC 3...
2025-09-06 18:48:00,378 - excel_processor - INFO - Extracting all data for AC 3
2025-09-06 18:48:00,379 - excel_processor - INFO - Found 5 party options for AC 3
2025-09-06 18:48:00,379 - excel_processor - INFO - Found 2 MP candidates for AC 3
2025-09-06 18:48:00,379 - excel_processor - INFO - Found 2 MLA candidates for AC 3
2025-09-06 18:48:00,379 - excel_processor - WARNING - No Congress candidates found for AC 3
2025-09-06 18:48:00,380 - excel_processor - INFO - Found 2 caste options for AC 3
2025-09-06 18:48:00,380 - __main__ - INFO - Successfully extracted data for AC 3
2025-09-06 18:48:00,380 - __main__ - INFO - Successfully extracted data for 3 AC numbers
2025-09-06 18:48:00,380 - __main__ - INFO - Validating extracted data...
2025-09-06 18:48:00,380 - data_validator - INFO - Data validation summary for 3 AC numbers:
2025-09-06 18:48:00,380 - data_validator - INFO - AC 1: All data available
2025-09-06 18:48:00,380 - data_validator - INFO - AC 2: All data available
2025-09-06 18:48:00,380 - data_validator - INFO - AC 3: All data available
2025-09-06 18:48:00,380 - data_validator - INFO - All AC numbers have complete data
2025-09-06 18:48:00,380 - __main__ - INFO - Initializing Google Forms generator...
2025-09-06 18:48:00,380 - form_generator - INFO - Setting up Google Forms API authentication
2025-09-06 18:48:00,380 - form_generator - INFO - A browser window will open for authentication...
2025-09-06 18:48:18,692 - google_auth_oauthlib.flow - INFO - "GET /?state=S7irKVh46QI50PG7qeeiioECeNPkrl&code=4/0AVMBsJiOhBRbk-j7QzPslevhSmp_AHrjo_4SgHeHaurZVeqHEiy_26s2liiiSH9Dz-wq9A&scope=https://www.googleapis.com/auth/forms.body%20https://www.googleapis.com/auth/drive HTTP/1.1" 200 53
2025-09-06 18:48:19,076 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-06 18:48:19,079 - form_generator - INFO - Google Forms API setup successful
2025-09-06 18:48:20,700 - form_generator - WARNING - API test failed, but proceeding: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
2025-09-06 18:48:20,701 - __main__ - INFO - Google Forms generator initialized successfully
2025-09-06 18:48:20,702 - __main__ - INFO - Generating Google Form...
2025-09-06 18:48:22,095 - form_generator - WARNING - Create form failed (attempt 1), retrying in 2s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
2025-09-06 18:48:25,477 - form_generator - WARNING - Create form failed (attempt 2), retrying in 4s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
2025-09-06 18:48:30,826 - form_generator - ERROR - Create form failed after 3 attempts: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
2025-09-06 18:48:30,826 - __main__ - ERROR - Unexpected error: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
Traceback (most recent call last):
  File "/Users/amartyaanand/Desktop/gform_agent/main.py", line 210, in main
    form_metadata = form_generator.generate_complete_form(all_ac_data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 558, in generate_complete_form
    form_result = self.create_form(form_title)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 149, in create_form
    result = self._execute_with_retry(create_operation, "Create form")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 116, in _execute_with_retry
    return operation()
           ^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 147, in create_operation
    return self.service.forms().create(body=form_body).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms?alt=json returned "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.". Details: "Only info.title can be set when creating a form. To add items and change settings, use batchUpdate.">
2025-09-06 18:49:33,818 - __main__ - INFO - Starting Political Survey Google Forms Automation Agent
2025-09-06 18:49:33,818 - __main__ - INFO - Loading configuration...
2025-09-06 18:49:33,820 - __main__ - INFO - Configuration loaded successfully
2025-09-06 18:49:33,820 - __main__ - INFO - Initializing Excel processor...
2025-09-06 18:49:33,820 - excel_processor - INFO - Loading Excel file: ./survey_data.xlsx
2025-09-06 18:49:33,933 - excel_processor - INFO - Loaded sheet 'AC<>PC' with 3 rows
2025-09-06 18:49:33,936 - excel_processor - INFO - Loaded sheet 'GE2024' with 6 rows
2025-09-06 18:49:33,940 - excel_processor - INFO - Loaded sheet 'MLA_P2' with 6 rows
2025-09-06 18:49:33,943 - excel_processor - INFO - Loaded sheet 'Caste_Data' with 6 rows
2025-09-06 18:49:33,944 - __main__ - INFO - Excel processor initialized successfully
2025-09-06 18:49:33,944 - __main__ - INFO - Extracting AC numbers from Excel data...
2025-09-06 18:49:33,945 - excel_processor - INFO - Found 3 AC numbers in ac_pc
2025-09-06 18:49:33,945 - excel_processor - INFO - Found 3 AC numbers in ge2024
2025-09-06 18:49:33,945 - excel_processor - INFO - Found 3 AC numbers in mla_p2
2025-09-06 18:49:33,945 - excel_processor - INFO - Found 3 AC numbers in caste_data
2025-09-06 18:49:33,945 - excel_processor - INFO - Total unique AC numbers found: 3
2025-09-06 18:49:33,945 - __main__ - INFO - Found 3 unique AC numbers
2025-09-06 18:49:33,945 - __main__ - INFO - Extracting survey data for all AC numbers...
2025-09-06 18:49:33,945 - __main__ - INFO - Processing AC 1...
2025-09-06 18:49:33,945 - excel_processor - INFO - Extracting all data for AC 1
2025-09-06 18:49:33,946 - excel_processor - INFO - Found 5 party options for AC 1
2025-09-06 18:49:33,947 - excel_processor - INFO - Found 2 MP candidates for AC 1
2025-09-06 18:49:33,947 - excel_processor - INFO - Found 2 MLA candidates for AC 1
2025-09-06 18:49:33,947 - excel_processor - INFO - Found 1 Congress candidates for AC 1
2025-09-06 18:49:33,948 - excel_processor - INFO - Found 2 caste options for AC 1
2025-09-06 18:49:33,948 - __main__ - INFO - Successfully extracted data for AC 1
2025-09-06 18:49:33,948 - __main__ - INFO - Processing AC 2...
2025-09-06 18:49:33,948 - excel_processor - INFO - Extracting all data for AC 2
2025-09-06 18:49:33,948 - excel_processor - INFO - Found 5 party options for AC 2
2025-09-06 18:49:33,948 - excel_processor - INFO - Found 2 MP candidates for AC 2
2025-09-06 18:49:33,948 - excel_processor - INFO - Found 2 MLA candidates for AC 2
2025-09-06 18:49:33,949 - excel_processor - INFO - Found 1 Congress candidates for AC 2
2025-09-06 18:49:33,949 - excel_processor - INFO - Found 2 caste options for AC 2
2025-09-06 18:49:33,949 - __main__ - INFO - Successfully extracted data for AC 2
2025-09-06 18:49:33,949 - __main__ - INFO - Processing AC 3...
2025-09-06 18:49:33,949 - excel_processor - INFO - Extracting all data for AC 3
2025-09-06 18:49:33,949 - excel_processor - INFO - Found 5 party options for AC 3
2025-09-06 18:49:33,949 - excel_processor - INFO - Found 2 MP candidates for AC 3
2025-09-06 18:49:33,949 - excel_processor - INFO - Found 2 MLA candidates for AC 3
2025-09-06 18:49:33,950 - excel_processor - WARNING - No Congress candidates found for AC 3
2025-09-06 18:49:33,950 - excel_processor - INFO - Found 2 caste options for AC 3
2025-09-06 18:49:33,950 - __main__ - INFO - Successfully extracted data for AC 3
2025-09-06 18:49:33,950 - __main__ - INFO - Successfully extracted data for 3 AC numbers
2025-09-06 18:49:33,950 - __main__ - INFO - Validating extracted data...
2025-09-06 18:49:33,950 - data_validator - INFO - Data validation summary for 3 AC numbers:
2025-09-06 18:49:33,950 - data_validator - INFO - AC 1: All data available
2025-09-06 18:49:33,950 - data_validator - INFO - AC 2: All data available
2025-09-06 18:49:33,950 - data_validator - INFO - AC 3: All data available
2025-09-06 18:49:33,950 - data_validator - INFO - All AC numbers have complete data
2025-09-06 18:49:33,950 - __main__ - INFO - Initializing Google Forms generator...
2025-09-06 18:49:33,950 - form_generator - INFO - Setting up Google Forms API authentication
2025-09-06 18:49:33,950 - form_generator - INFO - A browser window will open for authentication...
2025-09-06 18:49:39,108 - google_auth_oauthlib.flow - INFO - "GET /?state=SB8cLYPU7l9SVFcxGo4PAlkANShBbH&code=4/0AVMBsJgUXuyWbZCg1rZVeQtktUPTxqtCMkbFMuXjFwUf0r2R4IY0Rq8AHoo_4tnkMPozVA&scope=https://www.googleapis.com/auth/forms.body%20https://www.googleapis.com/auth/drive HTTP/1.1" 200 53
2025-09-06 18:49:39,498 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-06 18:49:39,500 - form_generator - INFO - Google Forms API setup successful
2025-09-06 18:49:42,248 - form_generator - INFO - ✓ Google Forms API connection successful
2025-09-06 18:49:42,248 - form_generator - INFO - Test form created and accessible: 1DjE-8SZNj2ClkDKwErZimmR-yq-o8-sZbA96ixLWFdM
2025-09-06 18:49:42,249 - __main__ - INFO - Google Forms generator initialized successfully
2025-09-06 18:49:42,249 - __main__ - INFO - Generating Google Form...
2025-09-06 18:49:43,810 - form_generator - INFO - Created form: Assam Political Survey - AC Multiple ACs (ID: 1M8w3nZ__diDqRPUoKH0Z-lpNdswXxq4V-qt1AVsOMmg)
2025-09-06 18:49:45,511 - form_generator - INFO - Updated form description
2025-09-06 18:49:47,013 - form_generator - ERROR - Error generating form: 'item'
2025-09-06 18:49:47,014 - form_generator - WARNING - Form deletion not implemented for form 1M8w3nZ__diDqRPUoKH0Z-lpNdswXxq4V-qt1AVsOMmg
2025-09-06 18:49:47,014 - form_generator - INFO - Cleaned up partially created form
2025-09-06 18:49:47,015 - __main__ - ERROR - Unexpected error: 'item'
Traceback (most recent call last):
  File "/Users/amartyaanand/Desktop/gform_agent/main.py", line 210, in main
    form_metadata = form_generator.generate_complete_form(all_ac_data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 592, in generate_complete_form
    intro_id = self.add_introduction_section(form_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 212, in add_introduction_section
    item_id = result['replies'][0]['createItem']['item']['itemId']
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
KeyError: 'item'
2025-09-06 18:50:33,546 - __main__ - INFO - Starting Political Survey Google Forms Automation Agent
2025-09-06 18:50:33,546 - __main__ - INFO - Loading configuration...
2025-09-06 18:50:33,548 - __main__ - INFO - Configuration loaded successfully
2025-09-06 18:50:33,548 - __main__ - INFO - Initializing Excel processor...
2025-09-06 18:50:33,548 - excel_processor - INFO - Loading Excel file: ./survey_data.xlsx
2025-09-06 18:50:33,676 - excel_processor - INFO - Loaded sheet 'AC<>PC' with 3 rows
2025-09-06 18:50:33,678 - excel_processor - INFO - Loaded sheet 'GE2024' with 6 rows
2025-09-06 18:50:33,681 - excel_processor - INFO - Loaded sheet 'MLA_P2' with 6 rows
2025-09-06 18:50:33,684 - excel_processor - INFO - Loaded sheet 'Caste_Data' with 6 rows
2025-09-06 18:50:33,685 - __main__ - INFO - Excel processor initialized successfully
2025-09-06 18:50:33,685 - __main__ - INFO - Extracting AC numbers from Excel data...
2025-09-06 18:50:33,685 - excel_processor - INFO - Found 3 AC numbers in ac_pc
2025-09-06 18:50:33,686 - excel_processor - INFO - Found 3 AC numbers in ge2024
2025-09-06 18:50:33,686 - excel_processor - INFO - Found 3 AC numbers in mla_p2
2025-09-06 18:50:33,686 - excel_processor - INFO - Found 3 AC numbers in caste_data
2025-09-06 18:50:33,686 - excel_processor - INFO - Total unique AC numbers found: 3
2025-09-06 18:50:33,686 - __main__ - INFO - Found 3 unique AC numbers
2025-09-06 18:50:33,686 - __main__ - INFO - Extracting survey data for all AC numbers...
2025-09-06 18:50:33,686 - __main__ - INFO - Processing AC 1...
2025-09-06 18:50:33,686 - excel_processor - INFO - Extracting all data for AC 1
2025-09-06 18:50:33,687 - excel_processor - INFO - Found 5 party options for AC 1
2025-09-06 18:50:33,688 - excel_processor - INFO - Found 2 MP candidates for AC 1
2025-09-06 18:50:33,688 - excel_processor - INFO - Found 2 MLA candidates for AC 1
2025-09-06 18:50:33,688 - excel_processor - INFO - Found 1 Congress candidates for AC 1
2025-09-06 18:50:33,689 - excel_processor - INFO - Found 2 caste options for AC 1
2025-09-06 18:50:33,689 - __main__ - INFO - Successfully extracted data for AC 1
2025-09-06 18:50:33,689 - __main__ - INFO - Processing AC 2...
2025-09-06 18:50:33,689 - excel_processor - INFO - Extracting all data for AC 2
2025-09-06 18:50:33,689 - excel_processor - INFO - Found 5 party options for AC 2
2025-09-06 18:50:33,689 - excel_processor - INFO - Found 2 MP candidates for AC 2
2025-09-06 18:50:33,689 - excel_processor - INFO - Found 2 MLA candidates for AC 2
2025-09-06 18:50:33,690 - excel_processor - INFO - Found 1 Congress candidates for AC 2
2025-09-06 18:50:33,690 - excel_processor - INFO - Found 2 caste options for AC 2
2025-09-06 18:50:33,690 - __main__ - INFO - Successfully extracted data for AC 2
2025-09-06 18:50:33,690 - __main__ - INFO - Processing AC 3...
2025-09-06 18:50:33,690 - excel_processor - INFO - Extracting all data for AC 3
2025-09-06 18:50:33,691 - excel_processor - INFO - Found 5 party options for AC 3
2025-09-06 18:50:33,691 - excel_processor - INFO - Found 2 MP candidates for AC 3
2025-09-06 18:50:33,691 - excel_processor - INFO - Found 2 MLA candidates for AC 3
2025-09-06 18:50:33,692 - excel_processor - WARNING - No Congress candidates found for AC 3
2025-09-06 18:50:33,692 - excel_processor - INFO - Found 2 caste options for AC 3
2025-09-06 18:50:33,692 - __main__ - INFO - Successfully extracted data for AC 3
2025-09-06 18:50:33,692 - __main__ - INFO - Successfully extracted data for 3 AC numbers
2025-09-06 18:50:33,692 - __main__ - INFO - Validating extracted data...
2025-09-06 18:50:33,692 - data_validator - INFO - Data validation summary for 3 AC numbers:
2025-09-06 18:50:33,692 - data_validator - INFO - AC 1: All data available
2025-09-06 18:50:33,692 - data_validator - INFO - AC 2: All data available
2025-09-06 18:50:33,692 - data_validator - INFO - AC 3: All data available
2025-09-06 18:50:33,692 - data_validator - INFO - All AC numbers have complete data
2025-09-06 18:50:33,692 - __main__ - INFO - Initializing Google Forms generator...
2025-09-06 18:50:33,692 - form_generator - INFO - Setting up Google Forms API authentication
2025-09-06 18:50:33,692 - form_generator - INFO - A browser window will open for authentication...
2025-09-06 18:50:39,772 - google_auth_oauthlib.flow - INFO - "GET /?state=uzQj2UK1FsL36EDs4pxlmuTXSXIMq1&code=4/0AVMBsJiEHVQwOG3mEfZydPzEmhgNmHqSGuR6galOoBPIhJebbzJAUrOsnxdiU5TudtiTeA&scope=https://www.googleapis.com/auth/forms.body%20https://www.googleapis.com/auth/drive HTTP/1.1" 200 53
2025-09-06 18:50:40,177 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-06 18:50:40,180 - form_generator - INFO - Google Forms API setup successful
2025-09-06 18:50:43,206 - form_generator - INFO - ✓ Google Forms API connection successful
2025-09-06 18:50:43,206 - form_generator - INFO - Test form created and accessible: 1ZSLnuFhbdNGUoGe7P-nz8PEpMCaeEcpNCT5iAXrQ96A
2025-09-06 18:50:43,207 - __main__ - INFO - Google Forms generator initialized successfully
2025-09-06 18:50:43,207 - __main__ - INFO - Generating Google Form...
2025-09-06 18:50:45,664 - form_generator - INFO - Created form: Assam Political Survey - AC Multiple ACs (ID: 1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug)
2025-09-06 18:50:47,299 - form_generator - INFO - Updated form description
2025-09-06 18:50:48,810 - form_generator - ERROR - Error extracting item ID from response: 'item'
2025-09-06 18:50:48,810 - form_generator - ERROR - Response structure: {'replies': [{'createItem': {'itemId': '3ba4052c'}}], 'writeControl': {'requiredRevisionId': '00000005'}}
2025-09-06 18:50:50,114 - form_generator - WARNING - Add basic info section failed (attempt 1), retrying in 2s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
2025-09-06 18:50:52,776 - form_generator - WARNING - Add basic info section failed (attempt 2), retrying in 4s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
2025-09-06 18:50:58,153 - form_generator - ERROR - Add basic info section failed after 3 attempts: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
2025-09-06 18:50:58,154 - form_generator - ERROR - Error generating form: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
2025-09-06 18:50:58,154 - form_generator - WARNING - Form deletion not implemented for form 1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug
2025-09-06 18:50:58,154 - form_generator - INFO - Cleaned up partially created form
2025-09-06 18:50:58,154 - __main__ - ERROR - Unexpected error: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
Traceback (most recent call last):
  File "/Users/amartyaanand/Desktop/gform_agent/main.py", line 210, in main
    form_metadata = form_generator.generate_complete_form(all_ac_data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 618, in generate_complete_form
    basic_info_ids = self.add_basic_info_section(form_id, ac_numbers)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 305, in add_basic_info_section
    result = self._execute_with_retry(update_operation, "Add basic info section")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 115, in _execute_with_retry
    return operation()
           ^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 303, in update_operation
    return self.service.forms().batchUpdate(formId=form_id, body=request_body).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1Pppo-oLJCSPKOKLsb4Cl3BbcQHUy2PMdUjPa7UqKcug:batchUpdate?alt=json returned "Invalid JSON payload received. Unknown name "textQuestion" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[0].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "textQuestion" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[1].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[2].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "choiceQuestion" at 'requests[3].create_item.item': Cannot find field.
Invalid JSON payload received. Unknown name "required" at 'requests[3].create_item.item': Cannot find field.". Details: "[{'@type': 'type.googleapis.com/google.rpc.BadRequest', 'fieldViolations': [{'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[0].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[0].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "textQuestion" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[1].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[1].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[2].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[2].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "choiceQuestion" at \'requests[3].create_item.item\': Cannot find field.'}, {'field': 'requests[3].create_item.item', 'description': 'Invalid JSON payload received. Unknown name "required" at \'requests[3].create_item.item\': Cannot find field.'}]}]">
2025-09-06 19:03:54,829 - __main__ - INFO - Starting Political Survey Google Forms Automation Agent
2025-09-06 19:03:54,830 - __main__ - INFO - Loading configuration...
2025-09-06 19:03:54,833 - __main__ - INFO - Configuration loaded successfully
2025-09-06 19:03:54,833 - __main__ - INFO - Initializing Excel processor...
2025-09-06 19:03:54,833 - excel_processor - INFO - Loading Excel file: ./survey_data.xlsx
2025-09-06 19:03:55,130 - excel_processor - INFO - Loaded sheet 'AC<>PC' with 3 rows
2025-09-06 19:03:55,133 - excel_processor - INFO - Loaded sheet 'GE2024' with 6 rows
2025-09-06 19:03:55,136 - excel_processor - INFO - Loaded sheet 'MLA_P2' with 6 rows
2025-09-06 19:03:55,139 - excel_processor - INFO - Loaded sheet 'Caste_Data' with 6 rows
2025-09-06 19:03:55,139 - __main__ - INFO - Excel processor initialized successfully
2025-09-06 19:03:55,139 - __main__ - INFO - Extracting AC numbers from Excel data...
2025-09-06 19:03:55,140 - excel_processor - INFO - Found 3 AC numbers in ac_pc
2025-09-06 19:03:55,140 - excel_processor - INFO - Found 3 AC numbers in ge2024
2025-09-06 19:03:55,140 - excel_processor - INFO - Found 3 AC numbers in mla_p2
2025-09-06 19:03:55,140 - excel_processor - INFO - Found 3 AC numbers in caste_data
2025-09-06 19:03:55,140 - excel_processor - INFO - Total unique AC numbers found: 3
2025-09-06 19:03:55,140 - __main__ - INFO - Found 3 unique AC numbers
2025-09-06 19:03:55,140 - __main__ - INFO - Extracting survey data for all AC numbers...
2025-09-06 19:03:55,140 - __main__ - INFO - Processing AC 1...
2025-09-06 19:03:55,140 - excel_processor - INFO - Extracting all data for AC 1
2025-09-06 19:03:55,141 - excel_processor - INFO - Found 5 party options for AC 1
2025-09-06 19:03:55,141 - excel_processor - INFO - Found 2 MP candidates for AC 1
2025-09-06 19:03:55,141 - excel_processor - INFO - Found 2 MLA candidates for AC 1
2025-09-06 19:03:55,142 - excel_processor - INFO - Found 1 Congress candidates for AC 1
2025-09-06 19:03:55,142 - excel_processor - INFO - Found 2 caste options for AC 1
2025-09-06 19:03:55,142 - __main__ - INFO - Successfully extracted data for AC 1
2025-09-06 19:03:55,142 - __main__ - INFO - Processing AC 2...
2025-09-06 19:03:55,142 - excel_processor - INFO - Extracting all data for AC 2
2025-09-06 19:03:55,142 - excel_processor - INFO - Found 5 party options for AC 2
2025-09-06 19:03:55,142 - excel_processor - INFO - Found 2 MP candidates for AC 2
2025-09-06 19:03:55,143 - excel_processor - INFO - Found 2 MLA candidates for AC 2
2025-09-06 19:03:55,143 - excel_processor - INFO - Found 1 Congress candidates for AC 2
2025-09-06 19:03:55,143 - excel_processor - INFO - Found 2 caste options for AC 2
2025-09-06 19:03:55,143 - __main__ - INFO - Successfully extracted data for AC 2
2025-09-06 19:03:55,143 - __main__ - INFO - Processing AC 3...
2025-09-06 19:03:55,143 - excel_processor - INFO - Extracting all data for AC 3
2025-09-06 19:03:55,143 - excel_processor - INFO - Found 5 party options for AC 3
2025-09-06 19:03:55,143 - excel_processor - INFO - Found 2 MP candidates for AC 3
2025-09-06 19:03:55,144 - excel_processor - INFO - Found 2 MLA candidates for AC 3
2025-09-06 19:03:55,144 - excel_processor - WARNING - No Congress candidates found for AC 3
2025-09-06 19:03:55,144 - excel_processor - INFO - Found 2 caste options for AC 3
2025-09-06 19:03:55,144 - __main__ - INFO - Successfully extracted data for AC 3
2025-09-06 19:03:55,144 - __main__ - INFO - Successfully extracted data for 3 AC numbers
2025-09-06 19:03:55,144 - __main__ - INFO - Validating extracted data...
2025-09-06 19:03:55,144 - data_validator - INFO - Data validation summary for 3 AC numbers:
2025-09-06 19:03:55,144 - data_validator - INFO - AC 1: All data available
2025-09-06 19:03:55,144 - data_validator - INFO - AC 2: All data available
2025-09-06 19:03:55,144 - data_validator - INFO - AC 3: All data available
2025-09-06 19:03:55,144 - data_validator - INFO - All AC numbers have complete data
2025-09-06 19:03:55,144 - __main__ - INFO - Initializing Google Forms generator...
2025-09-06 19:03:55,144 - form_generator - INFO - Setting up Google Forms API authentication
2025-09-06 19:03:55,144 - form_generator - INFO - A browser window will open for authentication...
2025-09-06 19:04:03,665 - google_auth_oauthlib.flow - INFO - "GET /?state=gKL0IGQwl46r2qk98gwPXxqNiNXn8T&code=4/0AVMBsJj1s6obtQqNmywergl0dtDALvzterYjFdnXO1C-9nnK5UZ1wDub1et3oH76GJmxlg&scope=https://www.googleapis.com/auth/forms.body%20https://www.googleapis.com/auth/drive HTTP/1.1" 200 53
2025-09-06 19:04:04,021 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-06 19:04:04,023 - form_generator - INFO - Google Forms API setup successful
2025-09-06 19:04:06,892 - form_generator - INFO - ✓ Google Forms API connection successful
2025-09-06 19:04:06,893 - form_generator - INFO - Test form created and accessible: 1QpLk4Vsg-HSp93PaR7TAeKEuxsXu-IL699bG0EcnX-g
2025-09-06 19:04:06,894 - __main__ - INFO - Google Forms generator initialized successfully
2025-09-06 19:04:06,894 - __main__ - INFO - Generating Google Form...
2025-09-06 19:04:09,295 - form_generator - INFO - Created form: Assam Political Survey - AC Multiple ACs (ID: 1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8)
2025-09-06 19:04:10,851 - form_generator - INFO - Updated form description
2025-09-06 19:04:12,399 - form_generator - ERROR - Error extracting item ID from response: 'item'
2025-09-06 19:04:12,400 - form_generator - ERROR - Response structure: {'replies': [{'createItem': {'itemId': '521ffe51'}}], 'writeControl': {'requiredRevisionId': '00000005'}}
2025-09-06 19:04:13,983 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:04:13,983 - form_generator - ERROR - Response structure: {'replies': [{'createItem': {'itemId': '469e17a6', 'questionId': ['6218489c']}}, {'createItem': {'itemId': '139031d7', 'questionId': ['46258644']}}, {'createItem': {'itemId': '6b6c0c0c', 'questionId': ['7f5c36f4']}}, {'createItem': {'itemId': '4e4732ce', 'questionId': ['767a473d']}}], 'writeControl': {'requiredRevisionId': '00000006'}}
2025-09-06 19:04:13,983 - form_generator - INFO - Added basic info section with 4 questions
2025-09-06 19:04:15,297 - form_generator - WARNING - Add AC 1 section failed (attempt 1), retrying in 2s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
2025-09-06 19:04:17,634 - form_generator - WARNING - Add AC 1 section failed (attempt 2), retrying in 4s: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
2025-09-06 19:04:23,118 - form_generator - ERROR - Add AC 1 section failed after 3 attempts: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
2025-09-06 19:04:23,119 - form_generator - ERROR - Error generating form: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
2025-09-06 19:04:23,119 - form_generator - WARNING - Form deletion not implemented for form 1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8
2025-09-06 19:04:23,119 - form_generator - INFO - Cleaned up partially created form
2025-09-06 19:04:23,119 - __main__ - ERROR - Unexpected error: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
Traceback (most recent call last):
  File "/Users/amartyaanand/Desktop/gform_agent/main.py", line 210, in main
    form_metadata = form_generator.generate_complete_form(all_ac_data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 674, in generate_complete_form
    section_ids, next_index = self.add_ac_specific_section(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 517, in add_ac_specific_section
    result = self._execute_with_retry(update_operation, f"Add AC {ac_number} section")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 115, in _execute_with_retry
    return operation()
           ^^^^^^^^^^^
  File "/Users/amartyaanand/Desktop/gform_agent/form_generator.py", line 515, in update_operation
    return self.service.forms().batchUpdate(formId=form_id, body=request_body).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/_helpers.py", line 130, in positional_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/googleapiclient/http.py", line 938, in execute
    raise HttpError(resp, content, uri=self.uri)
googleapiclient.errors.HttpError: <HttpError 400 when requesting https://forms.googleapis.com/v1/forms/1jB_KOuD9_XHgMwhfagl8bA_hQnHSttzmXEOtVCR6Ru8:batchUpdate?alt=json returned "Displayed text cannot contain newlines". Details: "Displayed text cannot contain newlines">
2025-09-06 19:06:03,653 - __main__ - INFO - Starting Political Survey Google Forms Automation Agent
2025-09-06 19:06:03,653 - __main__ - INFO - Loading configuration...
2025-09-06 19:06:03,656 - __main__ - INFO - Configuration loaded successfully
2025-09-06 19:06:03,656 - __main__ - INFO - Initializing Excel processor...
2025-09-06 19:06:03,656 - excel_processor - INFO - Loading Excel file: ./survey_data.xlsx
2025-09-06 19:06:03,778 - excel_processor - INFO - Loaded sheet 'AC<>PC' with 3 rows
2025-09-06 19:06:03,781 - excel_processor - INFO - Loaded sheet 'GE2024' with 6 rows
2025-09-06 19:06:03,784 - excel_processor - INFO - Loaded sheet 'MLA_P2' with 6 rows
2025-09-06 19:06:03,787 - excel_processor - INFO - Loaded sheet 'Caste_Data' with 6 rows
2025-09-06 19:06:03,788 - __main__ - INFO - Excel processor initialized successfully
2025-09-06 19:06:03,788 - __main__ - INFO - Extracting AC numbers from Excel data...
2025-09-06 19:06:03,789 - excel_processor - INFO - Found 3 AC numbers in ac_pc
2025-09-06 19:06:03,789 - excel_processor - INFO - Found 3 AC numbers in ge2024
2025-09-06 19:06:03,789 - excel_processor - INFO - Found 3 AC numbers in mla_p2
2025-09-06 19:06:03,789 - excel_processor - INFO - Found 3 AC numbers in caste_data
2025-09-06 19:06:03,789 - excel_processor - INFO - Total unique AC numbers found: 3
2025-09-06 19:06:03,789 - __main__ - INFO - Found 3 unique AC numbers
2025-09-06 19:06:03,789 - __main__ - INFO - Extracting survey data for all AC numbers...
2025-09-06 19:06:03,789 - __main__ - INFO - Processing AC 1...
2025-09-06 19:06:03,789 - excel_processor - INFO - Extracting all data for AC 1
2025-09-06 19:06:03,790 - excel_processor - INFO - Found 5 party options for AC 1
2025-09-06 19:06:03,790 - excel_processor - INFO - Found 2 MP candidates for AC 1
2025-09-06 19:06:03,791 - excel_processor - INFO - Found 2 MLA candidates for AC 1
2025-09-06 19:06:03,791 - excel_processor - INFO - Found 1 Congress candidates for AC 1
2025-09-06 19:06:03,791 - excel_processor - INFO - Found 2 caste options for AC 1
2025-09-06 19:06:03,791 - __main__ - INFO - Successfully extracted data for AC 1
2025-09-06 19:06:03,791 - __main__ - INFO - Processing AC 2...
2025-09-06 19:06:03,791 - excel_processor - INFO - Extracting all data for AC 2
2025-09-06 19:06:03,792 - excel_processor - INFO - Found 5 party options for AC 2
2025-09-06 19:06:03,792 - excel_processor - INFO - Found 2 MP candidates for AC 2
2025-09-06 19:06:03,792 - excel_processor - INFO - Found 2 MLA candidates for AC 2
2025-09-06 19:06:03,792 - excel_processor - INFO - Found 1 Congress candidates for AC 2
2025-09-06 19:06:03,792 - excel_processor - INFO - Found 2 caste options for AC 2
2025-09-06 19:06:03,792 - __main__ - INFO - Successfully extracted data for AC 2
2025-09-06 19:06:03,792 - __main__ - INFO - Processing AC 3...
2025-09-06 19:06:03,792 - excel_processor - INFO - Extracting all data for AC 3
2025-09-06 19:06:03,793 - excel_processor - INFO - Found 5 party options for AC 3
2025-09-06 19:06:03,793 - excel_processor - INFO - Found 2 MP candidates for AC 3
2025-09-06 19:06:03,793 - excel_processor - INFO - Found 2 MLA candidates for AC 3
2025-09-06 19:06:03,793 - excel_processor - WARNING - No Congress candidates found for AC 3
2025-09-06 19:06:03,793 - excel_processor - INFO - Found 2 caste options for AC 3
2025-09-06 19:06:03,793 - __main__ - INFO - Successfully extracted data for AC 3
2025-09-06 19:06:03,793 - __main__ - INFO - Successfully extracted data for 3 AC numbers
2025-09-06 19:06:03,793 - __main__ - INFO - Validating extracted data...
2025-09-06 19:06:03,793 - data_validator - INFO - Data validation summary for 3 AC numbers:
2025-09-06 19:06:03,794 - data_validator - INFO - AC 1: All data available
2025-09-06 19:06:03,794 - data_validator - INFO - AC 2: All data available
2025-09-06 19:06:03,794 - data_validator - INFO - AC 3: All data available
2025-09-06 19:06:03,794 - data_validator - INFO - All AC numbers have complete data
2025-09-06 19:06:03,794 - __main__ - INFO - Initializing Google Forms generator...
2025-09-06 19:06:03,794 - form_generator - INFO - Setting up Google Forms API authentication
2025-09-06 19:06:03,794 - form_generator - INFO - A browser window will open for authentication...
2025-09-06 19:06:16,887 - google_auth_oauthlib.flow - INFO - "GET /?state=rAotWSovoiSJfChFqKhoPEFMQGfUaW&code=4/0AVMBsJjTHkoszIJ2uU0U1g23uzgWAqLfuPXJEE7OA1OZEV4ae7GCzsmehfv8_2iPnpAHcA&scope=https://www.googleapis.com/auth/forms.body%20https://www.googleapis.com/auth/drive HTTP/1.1" 200 53
2025-09-06 19:06:17,355 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
2025-09-06 19:06:17,358 - form_generator - INFO - Google Forms API setup successful
2025-09-06 19:06:20,574 - form_generator - INFO - ✓ Google Forms API connection successful
2025-09-06 19:06:20,575 - form_generator - INFO - Test form created and accessible: 1_TZ9VYAnRRzUYukVf2VaOFcF6ZJvnTOpffjG4_Rn5Qc
2025-09-06 19:06:20,576 - __main__ - INFO - Google Forms generator initialized successfully
2025-09-06 19:06:20,576 - __main__ - INFO - Generating Google Form...
2025-09-06 19:06:23,137 - form_generator - INFO - Created form: Assam Political Survey - AC Multiple ACs (ID: 1IkcvZqrA--6DmqYxVCfVzkjRrAXPwcGwVQO9pkumAR0)
2025-09-06 19:06:24,728 - form_generator - INFO - Updated form description
2025-09-06 19:06:25,258 - form_generator - ERROR - Error extracting item ID from response: 'item'
2025-09-06 19:06:25,259 - form_generator - ERROR - Response structure: {'replies': [{'createItem': {'itemId': '392db46f'}}], 'writeControl': {'requiredRevisionId': '00000005'}}
2025-09-06 19:06:26,774 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:06:26,774 - form_generator - ERROR - Response structure: {'replies': [{'createItem': {'itemId': '28cca1eb', 'questionId': ['7c5b6feb']}}, {'createItem': {'itemId': '1ea25a9a', 'questionId': ['4162a354']}}, {'createItem': {'itemId': '03f14f54', 'questionId': ['76a7f589']}}, {'createItem': {'itemId': '216a139c', 'questionId': ['361ed24e']}}], 'writeControl': {'requiredRevisionId': '00000006'}}
2025-09-06 19:06:26,775 - form_generator - INFO - Added basic info section with 4 questions
2025-09-06 19:06:28,356 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:06:28,356 - form_generator - INFO - Added AC 1 section with 8 items
2025-09-06 19:06:29,994 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:06:29,995 - form_generator - INFO - Added AC 2 section with 8 items
2025-09-06 19:06:31,632 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:06:31,633 - form_generator - INFO - Added AC 3 section with 8 items
2025-09-06 19:06:33,214 - form_generator - ERROR - Error extracting item IDs from response: 'item'
2025-09-06 19:06:33,215 - form_generator - INFO - Added final section with 4 items
2025-09-06 19:06:33,215 - form_generator - INFO - Successfully generated complete form for 3 AC numbers
2025-09-06 19:06:33,215 - __main__ - INFO - Google Form generated successfully
2025-09-06 19:06:33,216 - __main__ - INFO - Form metadata saved to form_metadata.json
2025-09-06 19:06:33,217 - __main__ - INFO - Political Survey Google Forms Automation Agent completed successfully
